<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<style>

body{
  margin:0;
  padding:24px;
  font-family:-apple-system,Arial;
  background:#0b0d11;
  color:#e8eaed;
}

.header{
  font-size:56px;
  margin-bottom:18px;
}

.banner{
  padding:12px;
  border-radius:12px;
  margin-bottom:18px;
  font-weight:600;
}

.shift-SHIFT{background:#3a6df0;}
.shift-TEACHING{background:#7a3af0;}
.shift-OFF{background:#2a2f3a;}

.grid{
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:18px;
}

.panel{
  background:#151922;
  padding:18px;
  border-radius:16px;
}

.dayTitle{
  color:#8aa4ff;
  font-weight:600;
  margin-top:12px;
}

.event{margin:4px 0;}

.big{font-size:46px;font-weight:600;}

.small{color:#9aa3b2;font-size:13px;}

</style>
</head>

<body>

<div class="header" id="clock"></div>

<div id="shiftBanner" class="banner"></div>

<div class="panel" id="nowNext"></div>

<div class="grid">

<div class="panel">
<h3>Next 5 Days</h3>
<div id="calendar"></div>
</div>

<div>

<div class="panel" id="weather"></div>
<div class="panel" style="margin-top:18px;" id="tub"></div>

</div>

</div>

<div class="small" id="health"></div>

<script>

function clock(){
 document.getElementById("clock").innerHTML=
 new Date().toLocaleTimeString([],{
  hour:"2-digit",minute:"2-digit"
 });
}
clock();
setInterval(clock,1000);

fetch("YOUR_SCRIPT_URL")
.then(r=>r.json())
.then(d=>{

 renderShift(d.shift_state);
 renderNowNext(d);
 renderCalendar(d.events);
 renderWeather(d.weather);
 renderTub(d);
 renderHealth(d.api_updated);

});

function renderShift(s){
 var el=document.getElementById("shiftBanner");
 el.className="banner shift-"+s;
 el.innerHTML="Status: "+s;
}

function renderNowNext(d){

 var html="<b>Now</b><br>";

 if(d.now_event)
   html+=d.now_event.title+"<br>";
 else
   html+="No active event<br>";

 html+="<br><b>Next</b><br>";

 if(d.next_event)
   html+=d.next_event.title+"<br>"+
     new Date(d.next_event.start)
     .toLocaleTimeString([],{
       hour:"2-digit",minute:"2-digit"
     });

 document.getElementById("nowNext").innerHTML=html;
}

function renderCalendar(events){

 var grouped={};

 events.forEach(e=>{
  var d=new Date(e.start);
  var key=d.toDateString();
  if(!grouped[key])grouped[key]=[];
  grouped[key].push(e);
 });

 var html="";

 Object.keys(grouped).forEach(day=>{
  html+="<div class='dayTitle'>"+day+"</div>";
  grouped[day].forEach(e=>{
   var t=new Date(e.start)
    .toLocaleTimeString([],{
     hour:"2-digit",minute:"2-digit"
    });
   html+="<div class='event'>"+t+" — "+e.title+"</div>";
  });
 });

 document.getElementById("calendar").innerHTML=html;
}

function renderWeather(w){
 document.getElementById("weather").innerHTML=
 "<div class='big'>"+w.current+"°C</div>"+
 "High "+w.high+"° Low "+w.low;
}

function renderTub(t){
 document.getElementById("tub").innerHTML=
 "<div class='big'>"+t.current+"°</div>"+
 "Avg "+t.avg.toFixed(1)+"°";
}

function renderHealth(ts){
 document.getElementById("health").innerHTML=
 "System updated "+
 new Date(ts).toLocaleTimeString([],{
  hour:"2-digit",minute:"2-digit"
 });
}

setInterval(()=>location.reload(),600000);

</script>
</body>
</html>
